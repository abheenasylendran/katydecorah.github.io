---
title: Adventure Map
layout: no-container
---

<script src='https://api.tiles.mapbox.com/mapbox.js/{{site.mapboxjs}}/mapbox.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/{{site.mapboxjs}}/mapbox.css' rel='stylesheet' />

{% assign years = "2014|2013" | split: "|" %}
<div id='filters' class='map-select'>
{% for year in years %}<div><input type='checkbox' checked=checked class='filter'
name='filter' id='{{year}}' value='{{year}}'/><label for='{{year}}'>{{year}}</label></div>
{% endfor %}
</div>
<div id="map" class="map"></div>
<script>
L.mapbox.accessToken = '{{site.mapbox_token}}';
var map = L.mapbox.map('map', '{{site.mapbox_mapid}}');
var filters = document.getElementById('filters');
var checkboxes = document.getElementsByClassName('filter');
var featureLayer = L.mapbox.featureLayer()
.loadURL('/map/adventures.geojson')
.addTo(map);
featureLayer.on('ready', function() {
  map.fitBounds(featureLayer.getBounds());
  change();
});
//map.scrollWheelZoom.disable();
featureLayer.on('layeradd', function(e) {
  var marker = e.layer,
  feature = marker.feature;
  // Create custom popup content
  var popupContent =  '<a target="_blank" class="popup" href="' + feature.properties.url + '">' +
  '<img alt="'+ feature.properties.title +'+" src="' + feature.properties.image + '" /><h2 class="text-center">'+feature.properties.title+'</h2></a>';
  // http://leafletjs.com/reference.html#popup
  marker.bindPopup(popupContent,{
    minWidth: 150,
    closeButton: false
  });
});

function change() {
  var on = [];
  for (var i = 0; i < checkboxes.length; i++) {
    if (checkboxes[i].checked) on.push(checkboxes[i].value);
  }
  featureLayer.setFilter(function (f) {
    return on.indexOf(f.properties['year']) !== -1;
  });
  return false;
}
filters.onchange = change;
</script>
